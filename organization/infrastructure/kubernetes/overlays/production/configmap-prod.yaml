apiVersion: v1
kind: ConfigMap
metadata:
  name: broxiva-production-config
  namespace: broxiva-production
  labels:
    app: broxiva
    environment: production
data:
  # Application Configuration
  NODE_ENV: "production"
  APP_ENV: "production"
  LOG_LEVEL: "warn"
  ENABLE_DEBUG: "false"

  # API Configuration
  API_PORT: "4000"
  API_HOST: "0.0.0.0"
  API_DOMAIN: "https://api.broxiva.com"

  # Web Configuration
  WEB_PORT: "3000"
  WEB_HOST: "0.0.0.0"
  WEB_DOMAIN: "https://broxiva.com"
  NEXT_PUBLIC_API_URL: "https://api.broxiva.com"

  # Database Configuration (non-sensitive)
  DATABASE_HOST: "postgres-production.postgres.svc.cluster.local"
  DATABASE_PORT: "5432"
  DATABASE_NAME: "broxiva_production"
  DATABASE_SSL: "true"
  DATABASE_POOL_MIN: "10"
  DATABASE_POOL_MAX: "50"
  DATABASE_IDLE_TIMEOUT: "30000"
  DATABASE_CONNECTION_TIMEOUT: "5000"

  # Redis Configuration
  REDIS_HOST: "redis-production.redis.svc.cluster.local"
  REDIS_PORT: "6379"
  REDIS_DB: "0"
  REDIS_CLUSTER_MODE: "true"
  REDIS_MAX_RETRIES: "3"

  # Queue Configuration
  BULL_REDIS_HOST: "redis-production.redis.svc.cluster.local"
  BULL_REDIS_PORT: "6379"
  QUEUE_PREFIX: "prod-queue"
  QUEUE_LIMITER_MAX: "1000"
  QUEUE_LIMITER_DURATION: "60000"

  # Email Configuration
  SMTP_HOST: "smtp.sendgrid.net"
  SMTP_PORT: "587"
  EMAIL_FROM: "noreply@broxiva.com"
  EMAIL_FROM_NAME: "Broxiva"
  EMAIL_SUPPORT: "support@broxiva.com"

  # S3/Storage Configuration
  S3_BUCKET: "broxiva-production-assets"
  S3_REGION: "us-east-1"
  STORAGE_PROVIDER: "s3"
  CDN_URL: "https://cdn.broxiva.com"
  CLOUDFRONT_DISTRIBUTION_ID: "E1234567890ABC"

  # Payment Gateway Configuration
  STRIPE_MODE: "live"
  PAYPAL_MODE: "live"
  PAYMENT_TIMEOUT: "30000"

  # Feature Flags
  ENABLE_REGISTRATION: "true"
  ENABLE_PAYMENTS: "true"
  ENABLE_EMAIL_VERIFICATION: "true"
  ENABLE_2FA: "true"
  ENABLE_RATE_LIMITING: "true"
  ENABLE_IP_BLOCKING: "true"

  # Rate Limiting
  RATE_LIMIT_WINDOW_MS: "60000"
  RATE_LIMIT_MAX_REQUESTS: "60"
  STRICT_RATE_LIMIT_WINDOW_MS: "300000"
  STRICT_RATE_LIMIT_MAX_REQUESTS: "100"

  # Monitoring & Observability
  ENABLE_METRICS: "true"
  ENABLE_TRACING: "true"
  METRICS_PORT: "9090"
  TRACING_SAMPLE_RATE: "0.1"
  APM_SERVICE_NAME: "broxiva-production"

  # CORS Configuration
  CORS_ORIGIN: "https://broxiva.com,https://admin.broxiva.com,https://www.broxiva.com"
  CORS_CREDENTIALS: "true"

  # Session Configuration
  SESSION_COOKIE_DOMAIN: ".broxiva.com"
  SESSION_COOKIE_SECURE: "true"
  SESSION_COOKIE_SAMESITE: "strict"
  SESSION_COOKIE_HTTPONLY: "true"
  SESSION_LIFETIME: "86400"
  SESSION_ABSOLUTE_TIMEOUT: "604800"

  # Compliance & Security
  ENABLE_AUDIT_LOGGING: "true"
  ENABLE_DATA_ENCRYPTION: "true"
  ENCRYPTION_ALGORITHM: "aes-256-gcm"
  ENABLE_GDPR_COMPLIANCE: "true"
  ENABLE_CCPA_COMPLIANCE: "true"
  ENABLE_PCI_DSS_COMPLIANCE: "true"

  # Worker Configuration
  WORKER_CONCURRENCY: "10"
  WORKER_MAX_JOBS: "500"
  WORKER_RETRY_ATTEMPTS: "5"
  WORKER_RETRY_DELAY: "10000"
  WORKER_RETRY_BACKOFF: "exponential"

  # Cache Configuration
  CACHE_TTL: "600"
  CACHE_MAX_SIZE: "500mb"
  CACHE_STRATEGY: "lru"

  # Search Configuration
  ELASTICSEARCH_NODE: "https://elasticsearch-production.broxiva.com"
  ELASTICSEARCH_INDEX_PREFIX: "prod"
  ELASTICSEARCH_MAX_RETRIES: "3"

  # AI Services
  AI_SERVICE_URL: "https://ai.broxiva.com"
  AI_SERVICE_TIMEOUT: "45000"
  AI_MAX_RETRIES: "3"
  AI_ENABLE_FALLBACK: "true"

  # CDN & Performance
  ENABLE_CDN: "true"
  ENABLE_COMPRESSION: "true"
  COMPRESSION_LEVEL: "6"

  # Backup Configuration
  BACKUP_ENABLED: "true"
  BACKUP_RETENTION_DAYS: "90"

  # Health Check Configuration
  HEALTH_CHECK_TIMEOUT: "5000"
  READY_CHECK_TIMEOUT: "10000"

  # Graceful Shutdown
  SHUTDOWN_TIMEOUT: "30000"
  DRAIN_TIMEOUT: "25000"
