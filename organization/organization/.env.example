################################################################################
# Broxiva E-Commerce Platform - Environment Configuration
################################################################################
#
# INSTRUCTIONS:
#   1. Copy this file to .env: cp .env.example .env
#   2. Replace ALL placeholder values with real credentials
#   3. NEVER commit .env files to version control
#   4. For production: Use a secrets manager (AWS Secrets Manager, HashiCorp Vault, etc.)
#
# SECURITY NOTES:
#   - All passwords should be minimum 32 characters
#   - JWT secrets should be minimum 64 characters
#   - Encryption keys must be exactly 64 hex characters (32 bytes)
#   - Generate passwords: openssl rand -base64 32
#   - Generate JWT secrets: openssl rand -base64 64
#   - Generate encryption keys: openssl rand -hex 32
#
################################################################################

# ==============================================================================
# APPLICATION CONFIGURATION
# ==============================================================================

# Environment: development | staging | production
NODE_ENV=development

# Server Configuration
PORT=4000
API_PREFIX=/api

# Application URLs
FRONTEND_URL=http://localhost:3000
API_URL=http://localhost:4000

# CORS Configuration (comma-separated origins)
# SECURITY: Never use wildcards (*) in production
CORS_ALLOWED_ORIGINS=http://localhost:3000,http://localhost:3001,http://localhost:4200

# ==============================================================================
# DATABASE CONFIGURATION
# ==============================================================================
# SECURITY: Generate strong passwords with: openssl rand -base64 32

# PostgreSQL
POSTGRES_USER=broxiva
POSTGRES_PASSWORD=CHANGE_ME_GENERATE_SECURE_PASSWORD_MIN_32_CHARS
POSTGRES_DB=broxiva_dev
POSTGRES_HOST=localhost
POSTGRES_PORT=5432

# Full Database URL
# Format: postgresql://USER:PASSWORD@HOST:PORT/DATABASE?schema=public
DATABASE_URL=postgresql://broxiva:CHANGE_ME_PASSWORD@localhost:5432/broxiva_dev?schema=public

# Connection Pool Settings
DB_POOL_MIN=2
DB_POOL_MAX=10
DB_TIMEOUT=30000

# ==============================================================================
# REDIS CONFIGURATION
# ==============================================================================
# SECURITY: Set password in production: openssl rand -base64 32

REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=
REDIS_DB=0
REDIS_URL=redis://localhost:6379
REDIS_KEY_PREFIX=broxiva:
REDIS_TIMEOUT=5000

# ==============================================================================
# JWT AUTHENTICATION
# ==============================================================================
# CRITICAL: Generate secure secrets before deploying!
# - Generate with: openssl rand -base64 64
# - Minimum 64 characters required
# - JWT_SECRET and JWT_REFRESH_SECRET MUST be different

JWT_SECRET=CHANGE_ME_GENERATE_WITH_OPENSSL_RAND_BASE64_64_MINIMUM_64_CHARS
JWT_REFRESH_SECRET=CHANGE_ME_DIFFERENT_FROM_JWT_SECRET_OPENSSL_RAND_BASE64_64
JWT_EXPIRES_IN=1h
JWT_REFRESH_EXPIRES_IN=7d

# Session Secret (for cookie signing)
SESSION_SECRET=CHANGE_ME_GENERATE_WITH_OPENSSL_RAND_BASE64_64

# ==============================================================================
# ENCRYPTION CONFIGURATION
# ==============================================================================
# CRITICAL: Generate with: openssl rand -hex 32
# Must be exactly 64 hexadecimal characters (32 bytes)
# WARNING: If lost, encrypted data cannot be recovered

# General Encryption Key
ENCRYPTION_KEY=CHANGE_ME_EXACTLY_64_HEX_CHARACTERS_OPENSSL_RAND_HEX_32

# KYC Document Encryption Key
KYC_ENCRYPTION_KEY=CHANGE_ME_DIFFERENT_64_HEX_CHARS_FOR_KYC_DOCUMENTS

# ==============================================================================
# PAYMENT PROVIDERS
# ==============================================================================

# --- Stripe (Primary - Global) ---
# Get keys from: https://dashboard.stripe.com/apikeys
STRIPE_ENABLED=true
STRIPE_SECRET_KEY=sk_test_CHANGE_ME
STRIPE_PUBLISHABLE_KEY=pk_test_CHANGE_ME
STRIPE_WEBHOOK_SECRET=whsec_CHANGE_ME

# Frontend Stripe Key (must match STRIPE_PUBLISHABLE_KEY)
NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY=pk_test_CHANGE_ME

# Apple Pay / Google Pay (via Stripe)
APPLE_MERCHANT_ID=merchant.com.broxiva
GOOGLE_MERCHANT_ID=BCR2DN4TXXXXXXXX

# --- PayPal (Secondary - Global) ---
# Get from: https://developer.paypal.com/dashboard
PAYPAL_ENABLED=true
PAYPAL_CLIENT_ID=CHANGE_ME
PAYPAL_CLIENT_SECRET=CHANGE_ME
PAYPAL_MODE=sandbox
PAYPAL_WEBHOOK_ID=CHANGE_ME

# --- Flutterwave (African Markets) ---
# Get from: https://dashboard.flutterwave.com/
FLUTTERWAVE_ENABLED=false
FLUTTERWAVE_PUBLIC_KEY=FLWPUBK_TEST-CHANGE_ME
FLUTTERWAVE_SECRET_KEY=FLWSECK_TEST-CHANGE_ME
FLUTTERWAVE_ENCRYPTION_KEY=CHANGE_ME
FLUTTERWAVE_WEBHOOK_SECRET=CHANGE_ME

# --- Paystack (Nigeria, Ghana, South Africa, Kenya) ---
# Get from: https://dashboard.paystack.com/
PAYSTACK_ENABLED=false
PAYSTACK_PUBLIC_KEY=pk_test_CHANGE_ME
PAYSTACK_SECRET_KEY=sk_test_CHANGE_ME

# ==============================================================================
# IN-APP PURCHASES
# ==============================================================================

# Apple IAP (iOS StoreKit)
APPLE_SHARED_SECRET=CHANGE_ME
APPLE_BUNDLE_ID=com.broxiva.app
APPLE_ISSUER_ID=CHANGE_ME
APPLE_KEY_ID=CHANGE_ME
APPLE_PRIVATE_KEY=-----BEGIN PRIVATE KEY-----\nCHANGE_ME\n-----END PRIVATE KEY-----

# Google Play Billing (Android)
GOOGLE_PACKAGE_NAME=com.broxiva.app
GOOGLE_SERVICE_ACCOUNT_EMAIL=billing@project.iam.gserviceaccount.com
GOOGLE_SERVICE_ACCOUNT_PRIVATE_KEY=-----BEGIN PRIVATE KEY-----\nCHANGE_ME\n-----END PRIVATE KEY-----

# ==============================================================================
# AWS SERVICES (SNS, SES, SQS, S3)
# ==============================================================================
# NOTE: External providers (SendGrid, Twilio) are NOT supported per infrastructure policy

# Shared AWS Credentials
AWS_ACCESS_KEY_ID=CHANGE_ME
AWS_SECRET_ACCESS_KEY=CHANGE_ME
AWS_REGION=us-east-1

# AWS S3 (File Storage)
AWS_S3_BUCKET=broxiva-uploads

# AWS SES (Email)
AWS_SES_ACCESS_KEY_ID=
AWS_SES_SECRET_ACCESS_KEY=
AWS_SES_REGION=us-east-1
AWS_SES_FROM_EMAIL=noreply@broxiva.com
AWS_SES_FROM_NAME=Broxiva
AWS_SES_CONFIGURATION_SET=broxiva-emails

# AWS SNS (SMS)
AWS_SNS_ACCESS_KEY_ID=
AWS_SNS_SECRET_ACCESS_KEY=
AWS_SNS_REGION=us-east-1
AWS_SNS_SENDER_ID=Broxiva
AWS_SNS_DEFAULT_SMS_TYPE=Transactional

# AWS SQS (Message Queue)
AWS_SQS_ACCESS_KEY_ID=
AWS_SQS_SECRET_ACCESS_KEY=
AWS_SQS_REGION=us-east-1
AWS_SQS_QUEUE_NAME=broxiva-notifications
AWS_SQS_QUEUE_URL=https://sqs.us-east-1.amazonaws.com/123456789/broxiva-notifications
AWS_SQS_DLQ_URL=https://sqs.us-east-1.amazonaws.com/123456789/broxiva-notifications-dlq

# ==============================================================================
# STORAGE SERVICES
# ==============================================================================

# Storage Provider Selection (S3, AZURE, LOCAL)
STORAGE_PROVIDER=S3
STORAGE_BUCKET=broxiva-uploads

# MinIO (S3-Compatible Local Storage)
MINIO_ROOT_USER=broxiva_admin
MINIO_ROOT_PASSWORD=CHANGE_ME_MINIMUM_8_CHARS
MINIO_ENDPOINT=localhost
MINIO_PORT=9000
MINIO_USE_SSL=false
MINIO_BUCKET=broxiva-uploads
MINIO_ACCESS_KEY=CHANGE_ME
MINIO_SECRET_KEY=CHANGE_ME

# ==============================================================================
# MESSAGE QUEUE (RABBITMQ)
# ==============================================================================

RABBITMQ_USER=broxiva
RABBITMQ_PASSWORD=CHANGE_ME_SECURE_PASSWORD
RABBITMQ_HOST=localhost
RABBITMQ_PORT=5672
RABBITMQ_URL=amqp://broxiva:CHANGE_ME@localhost:5672
RABBITMQ_VHOST=/

# ==============================================================================
# SEARCH SERVICES
# ==============================================================================

# Search Provider Selection: elasticsearch | algolia | internal | auto
SEARCH_PROVIDER=auto

# Elasticsearch
ELASTICSEARCH_NODE=http://localhost:9200
ELASTICSEARCH_URL=http://localhost:9200
ELASTICSEARCH_USERNAME=
ELASTICSEARCH_PASSWORD=
ELASTICSEARCH_INDEX=broxiva-products
ELASTICSEARCH_INDEX_PREFIX=broxiva
ELASTICSEARCH_BULK_SIZE=1000
ELASTICSEARCH_REQUEST_TIMEOUT=30000

# Algolia (Alternative)
# Get from: https://www.algolia.com/account/api-keys/
ALGOLIA_APP_ID=CHANGE_ME
ALGOLIA_API_KEY=CHANGE_ME
ALGOLIA_INDEX_NAME=broxiva_products

# ==============================================================================
# SOCIAL LOGIN (OAUTH)
# ==============================================================================

# Google OAuth
# Get from: https://console.cloud.google.com/apis/credentials
GOOGLE_CLIENT_ID=CHANGE_ME.apps.googleusercontent.com
GOOGLE_CLIENT_SECRET=CHANGE_ME
GOOGLE_REDIRECT_URI=http://localhost:3000/auth/google/callback

# Facebook OAuth
# Get from: https://developers.facebook.com/apps/
FACEBOOK_APP_ID=CHANGE_ME
FACEBOOK_APP_SECRET=CHANGE_ME
FACEBOOK_REDIRECT_URI=http://localhost:3000/auth/facebook/callback

# GitHub OAuth
# Get from: https://github.com/settings/developers
GITHUB_CLIENT_ID=CHANGE_ME
GITHUB_CLIENT_SECRET=CHANGE_ME
GITHUB_REDIRECT_URI=http://localhost:3000/auth/github/callback

# Apple Sign In
# Get from: https://developer.apple.com/account/resources/identifiers/
APPLE_CLIENT_ID=com.broxiva.app
APPLE_TEAM_ID=CHANGE_ME

# ==============================================================================
# AI SERVICES
# ==============================================================================

# OpenAI
# Get from: https://platform.openai.com/api-keys
OPENAI_API_KEY=sk-proj-CHANGE_ME
OPENAI_ORGANIZATION=
OPENAI_MODEL=gpt-4-turbo-preview
OPENAI_MAX_TOKENS=2000
OPENAI_TEMPERATURE=0.7

# Anthropic (Claude)
# Get from: https://console.anthropic.com/
ANTHROPIC_API_KEY=sk-ant-CHANGE_ME
ANTHROPIC_MODEL=claude-3-5-sonnet-20241022
ANTHROPIC_MAX_TOKENS=4000

# LLM Provider Selection
LLM_PRIMARY_PROVIDER=openai
LLM_FALLBACK_PROVIDER=anthropic
LLM_ENABLE_TEMPLATE_FALLBACK=true

# Google Cloud (Vision API for Visual Search)
GOOGLE_CLOUD_PROJECT_ID=CHANGE_ME
GOOGLE_APPLICATION_CREDENTIALS=/path/to/credentials.json

# ==============================================================================
# KYC VERIFICATION
# ==============================================================================

# Provider Selection: onfido | jumio | sumsub | mock
KYC_PROVIDER=mock
KYC_OCR_PROVIDER=mock
KYC_FACE_PROVIDER=mock
KYC_COMPLIANCE_PROVIDER=mock

# Verification Settings
KYC_VERIFICATION_LEVEL=standard
KYC_AUTO_APPROVE_THRESHOLD=0.85
KYC_MANUAL_REVIEW_THRESHOLD=0.65
KYC_ENABLE_COMPLIANCE_SCREENING=true
KYC_ENABLE_FACE_VERIFICATION=true

# Onfido Configuration
ONFIDO_API_TOKEN=CHANGE_ME
ONFIDO_WEBHOOK_TOKEN=CHANGE_ME
ONFIDO_REGION=us

# Jumio Configuration
JUMIO_API_TOKEN=CHANGE_ME
JUMIO_API_SECRET=CHANGE_ME
JUMIO_WEBHOOK_SECRET=CHANGE_ME
JUMIO_DATACENTER=us

# Sumsub Configuration
SUMSUB_APP_TOKEN=CHANGE_ME
SUMSUB_SECRET_KEY=CHANGE_ME
SUMSUB_WEBHOOK_SECRET=CHANGE_ME

# ==============================================================================
# TAX CALCULATION
# ==============================================================================

# Provider Selection: taxjar | avalara | none
TAX_PROVIDER=none

# TaxJar
TAXJAR_API_KEY=CHANGE_ME
TAXJAR_ENVIRONMENT=sandbox

# Avalara
AVALARA_ACCOUNT_ID=CHANGE_ME
AVALARA_LICENSE_KEY=CHANGE_ME
AVALARA_COMPANY_CODE=DEFAULT
AVALARA_ENVIRONMENT=sandbox

# ==============================================================================
# MONITORING & LOGGING
# ==============================================================================

# Logging
LOG_LEVEL=debug
LOG_FORMAT=json
LOG_TO_FILE=false
LOG_FILE_PATH=/var/log/broxiva/api.log

# Sentry (Error Tracking)
# Get from: https://sentry.io/settings/projects/
SENTRY_DSN=
SENTRY_ENVIRONMENT=development
SENTRY_TRACES_SAMPLE_RATE=0.1

# Prometheus Metrics
ENABLE_METRICS=true
METRICS_PORT=9090

# ==============================================================================
# ANALYTICS & MARKETING
# ==============================================================================

# Google Analytics
GOOGLE_ANALYTICS_ID=

# Facebook Pixel
FACEBOOK_PIXEL_ID=
FACEBOOK_ACCESS_TOKEN=

# TikTok Pixel
TIKTOK_PIXEL_ID=
TIKTOK_ACCESS_TOKEN=

# ==============================================================================
# RECAPTCHA BOT PROTECTION
# ==============================================================================

# Get keys from: https://www.google.com/recaptcha/admin
RECAPTCHA_SITE_KEY=CHANGE_ME
RECAPTCHA_SECRET_KEY=CHANGE_ME
RECAPTCHA_SCORE_THRESHOLD=0.5
RECAPTCHA_ENABLED=true
RECAPTCHA_EXEMPT_IPS=
RECAPTCHA_CACHE_TTL=300

# ==============================================================================
# RATE LIMITING
# ==============================================================================

# Default Rate Limits
THROTTLE_TTL=60
THROTTLE_LIMIT=100

# Anonymous User Limits
THROTTLE_ANONYMOUS_TTL=60
THROTTLE_ANONYMOUS_LIMIT=30

# Auth Endpoint Limits
THROTTLE_AUTH_TTL=60
THROTTLE_AUTH_LIMIT=10

# Webhook Limits
THROTTLE_WEBHOOK_TTL=60
THROTTLE_WEBHOOK_LIMIT=100

# AI Endpoint Limits
THROTTLE_AI_TTL=60
THROTTLE_AI_LIMIT=5

# ==============================================================================
# MFA ENFORCEMENT
# ==============================================================================

MFA_REQUIRED_ROLES=ADMIN,VENDOR
MFA_GRACE_PERIOD_DAYS=7
MFA_TRUSTED_DEVICE_DAYS=30
MFA_ENABLE_TRUSTED_DEVICES=true

# ==============================================================================
# ADMIN TOOLS
# ==============================================================================

# Grafana Dashboard
GRAFANA_ADMIN_USER=admin
GRAFANA_ADMIN_PASSWORD=CHANGE_ME_SECURE_PASSWORD

# pgAdmin (Database UI)
PGADMIN_DEFAULT_EMAIL=admin@broxiva.com
PGADMIN_DEFAULT_PASSWORD=CHANGE_ME_SECURE_PASSWORD

# ==============================================================================
# FEATURE FLAGS
# ==============================================================================

FEATURE_AI_RECOMMENDATIONS=true
FEATURE_VISUAL_SEARCH=true
FEATURE_LIVE_CHAT=true
FEATURE_SOCIAL_LOGIN=true
FEATURE_MOBILE_APP_IAP=true

# ==============================================================================
# ALERT NOTIFICATIONS
# ==============================================================================

# Slack Webhook
SLACK_WEBHOOK_URL=

# PagerDuty
PAGERDUTY_API_KEY=

# Email Alert Recipients (comma-separated)
ALERT_EMAIL_RECIPIENTS=

# ==============================================================================
# FRONTEND PUBLIC CONFIGURATION
# ==============================================================================

NEXT_PUBLIC_API_URL=http://localhost:4000/api
NEXT_PUBLIC_AI_SERVICE_URL=http://localhost:8000
NEXT_PUBLIC_WS_URL=ws://localhost:4000
NEXT_PUBLIC_APP_NAME=Broxiva
NEXT_PUBLIC_APP_URL=http://localhost:3000
NEXT_PUBLIC_CDN_URL=
NEXT_PUBLIC_GOOGLE_CLIENT_ID=
NEXT_PUBLIC_GITHUB_CLIENT_ID=
NEXT_PUBLIC_FACEBOOK_APP_ID=
NEXT_PUBLIC_APPLE_CLIENT_ID=
NEXT_PUBLIC_ENABLE_AI_FEATURES=true
NEXT_PUBLIC_ENABLE_AR_TRYON=true
NEXT_PUBLIC_ENABLE_VOICE_SEARCH=true
NEXT_PUBLIC_ENABLE_CHATBOT=true
NEXT_PUBLIC_GA_TRACKING_ID=
NEXT_PUBLIC_FB_PIXEL_ID=
NEXT_PUBLIC_TIKTOK_PIXEL_ID=
NEXT_PUBLIC_SENTRY_DSN=
NEXT_PUBLIC_VAPID_PUBLIC_KEY=
NEXT_PUBLIC_IMAGE_OPTIMIZATION=true

################################################################################
# SECURITY CHECKLIST
################################################################################
#
# Before deploying, ensure:
#   [ ] All CHANGE_ME values replaced with real credentials
#   [ ] Strong passwords generated (minimum 32 characters)
#   [ ] JWT secrets are at least 64 characters
#   [ ] JWT_SECRET and JWT_REFRESH_SECRET are different
#   [ ] Encryption keys are exactly 64 hex characters
#   [ ] .env file is in .gitignore
#   [ ] Production secrets stored in secrets manager
#   [ ] No actual secrets in .env.example files
#   [ ] CORS origins restricted (no wildcards)
#   [ ] NODE_ENV set correctly for each environment
#   [ ] Payment providers in correct mode (test/live)
#
################################################################################
