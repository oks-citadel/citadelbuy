# Secrets and Sensitive Variables
# This file references Azure DevOps variable groups that contain secrets
# IMPORTANT: Never commit actual secret values to this file
#
# Architecture: Per-App-Per-Environment Vault Structure
# - citadelbuy-{env}-shared-kv: Cross-app secrets (DB, Redis)
# - citadelbuy-{env}-api-kv: API-specific secrets
# - citadelbuy-{env}-web-kv: Web-specific secrets
# - citadelbuy-{env}-mobile-kv: Mobile-specific secrets
# - citadelbuy-{env}-services-kv: Microservices secrets
#
# Secrets are pulled from Azure Key Vault using the AzureKeyVault@2 task

variables:
  # ============================================================
  # ENVIRONMENT-SPECIFIC VARIABLE GROUPS (Legacy - for reference)
  # ============================================================

  # Development Environment Secrets
  - group: 'citadelbuy-secrets-dev'

  # Staging Environment Secrets
  - group: 'citadelbuy-secrets-staging'

  # Production Environment Secrets
  - group: 'citadelbuy-secrets-prod'

  # Shared Secrets (Common across all environments)
  - group: 'citadelbuy-secrets-common'

  # ============================================================
  # KEY VAULT REFERENCES (Per-App-Per-Environment)
  # ============================================================

  # Key Vault Names by Environment
  - name: sharedVaultName
    value: 'citadelbuy-$(environment)-shared-kv'
  - name: apiVaultName
    value: 'citadelbuy-$(environment)-api-kv'
  - name: webVaultName
    value: 'citadelbuy-$(environment)-web-kv'
  - name: mobileVaultName
    value: 'citadelbuy-$(environment)-mobile-kv'
  - name: servicesVaultName
    value: 'citadelbuy-$(environment)-services-kv'

  # Azure Subscription for Key Vault access
  - name: azureSubscription
    value: 'CitadelBuy-ServiceConnection'

# ============================================================
# USAGE INSTRUCTIONS
# ============================================================
#
# 1. Pull secrets from Key Vault in your pipeline:
#
#    - task: AzureKeyVault@2
#      inputs:
#        azureSubscription: '$(azureSubscription)'
#        KeyVaultName: '$(apiVaultName)'
#        SecretsFilter: 'jwt-access-secret,jwt-refresh-secret,stripe-secret-key'
#        RunAsPreJob: true
#
# 2. Use secrets in your tasks:
#
#    - script: |
#        echo "Using secret..."
#      env:
#        JWT_SECRET: $(jwt-access-secret)
#        STRIPE_KEY: $(stripe-secret-key)
#
# 3. For different apps, use different vaults:
#    - API deployment: Use $(apiVaultName) + $(sharedVaultName)
#    - Web deployment: Use $(webVaultName) only
#    - Mobile deployment: Use $(mobileVaultName) only
#
# ============================================================
# VARIABLE GROUPS SETUP
# ============================================================
#
# Create these variable groups linked to Key Vault:
#
# 1. citadelbuy-{env}-shared-secrets
#    Source: citadelbuy-{env}-shared-kv
#    Secrets:
#    - postgres-url -> DATABASE_URL
#    - postgres-password -> POSTGRES_PASSWORD
#    - redis-url -> REDIS_URL
#
# 2. citadelbuy-{env}-api-secrets
#    Source: citadelbuy-{env}-api-kv
#    Secrets:
#    - jwt-access-secret -> JWT_SECRET
#    - jwt-refresh-secret -> JWT_REFRESH_SECRET
#    - stripe-secret-key -> STRIPE_SECRET_KEY
#    - stripe-webhook-secret -> STRIPE_WEBHOOK_SECRET
#    - sendgrid-api-key -> SENDGRID_API_KEY
#    - openai-api-key -> OPENAI_API_KEY
#    - kyc-encryption-key -> KYC_ENCRYPTION_KEY
#
# 3. citadelbuy-{env}-web-secrets
#    Source: citadelbuy-{env}-web-kv
#    Secrets:
#    - internal-api-key -> INTERNAL_API_KEY
#    - sentry-dsn -> SENTRY_DSN
#
# 4. citadelbuy-{env}-mobile-secrets
#    Source: citadelbuy-{env}-mobile-kv
#    Secrets:
#    - apple-shared-secret -> APPLE_SHARED_SECRET
#    - google-play-service-account-key -> GOOGLE_PLAY_SERVICE_ACCOUNT
#    - firebase-service-account -> FIREBASE_SERVICE_ACCOUNT
#
# Note: To link variable groups to Key Vault:
# 1. Go to Pipelines > Library > Variable Groups
# 2. Click "Link secrets from an Azure Key Vault"
# 3. Select the appropriate Key Vault
# 4. Authorize and select secrets to link
