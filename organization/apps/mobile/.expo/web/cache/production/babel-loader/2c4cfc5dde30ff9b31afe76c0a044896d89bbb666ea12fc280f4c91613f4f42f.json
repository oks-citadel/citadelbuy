{"ast":null,"code":"import _asyncToGenerator from\"@babel/runtime/helpers/asyncToGenerator\";import{create}from'zustand';import*as SecureStore from'expo-secure-store';import{api}from'../services/api';var TOKEN_KEY='auth_token';var USER_KEY='auth_user';export var useAuthStore=create(function(set,get){return{user:null,token:null,isAuthenticated:false,isLoading:true,error:null,login:function(){var _login=_asyncToGenerator(function*(email,password){set({isLoading:true,error:null});try{var response=yield api.post('/auth/login',{email:email,password:password});var _response$data=response.data,user=_response$data.user,accessToken=_response$data.accessToken;yield SecureStore.setItemAsync(TOKEN_KEY,accessToken);yield SecureStore.setItemAsync(USER_KEY,JSON.stringify(user));set({user:user,token:accessToken,isAuthenticated:true,isLoading:false});}catch(error){var _error$response,_error$response$data;set({error:((_error$response=error.response)==null?void 0:(_error$response$data=_error$response.data)==null?void 0:_error$response$data.message)||'Login failed',isLoading:false});throw error;}});function login(_x,_x2){return _login.apply(this,arguments);}return login;}(),register:function(){var _register=_asyncToGenerator(function*(name,email,password){set({isLoading:true,error:null});try{var response=yield api.post('/auth/register',{name:name,email:email,password:password});var _response$data2=response.data,user=_response$data2.user,accessToken=_response$data2.accessToken;yield SecureStore.setItemAsync(TOKEN_KEY,accessToken);yield SecureStore.setItemAsync(USER_KEY,JSON.stringify(user));set({user:user,token:accessToken,isAuthenticated:true,isLoading:false});}catch(error){var _error$response2,_error$response2$data;set({error:((_error$response2=error.response)==null?void 0:(_error$response2$data=_error$response2.data)==null?void 0:_error$response2$data.message)||'Registration failed',isLoading:false});throw error;}});function register(_x3,_x4,_x5){return _register.apply(this,arguments);}return register;}(),logout:function(){var _logout=_asyncToGenerator(function*(){yield SecureStore.deleteItemAsync(TOKEN_KEY);yield SecureStore.deleteItemAsync(USER_KEY);set({user:null,token:null,isAuthenticated:false});});function logout(){return _logout.apply(this,arguments);}return logout;}(),checkAuth:function(){var _checkAuth=_asyncToGenerator(function*(){try{var token=yield SecureStore.getItemAsync(TOKEN_KEY);var userJson=yield SecureStore.getItemAsync(USER_KEY);if(token&&userJson){var user=JSON.parse(userJson);set({user:user,token:token,isAuthenticated:true,isLoading:false});}else{set({isLoading:false});}}catch(error){set({isLoading:false});}});function checkAuth(){return _checkAuth.apply(this,arguments);}return checkAuth;}(),clearError:function clearError(){return set({error:null});}};});","map":{"version":3,"names":["create","SecureStore","api","TOKEN_KEY","USER_KEY","useAuthStore","set","get","user","token","isAuthenticated","isLoading","error","login","_login","_asyncToGenerator","email","password","response","post","_response$data","data","accessToken","setItemAsync","JSON","stringify","_error$response","_error$response$data","message","_x","_x2","apply","arguments","register","_register","name","_response$data2","_error$response2","_error$response2$data","_x3","_x4","_x5","logout","_logout","deleteItemAsync","checkAuth","_checkAuth","getItemAsync","userJson","parse","clearError"],"sources":["C:/Users/Dell/OneDrive/Documents/Citadelbuy/CitadelBuy/organization/apps/mobile/src/stores/auth-store.ts"],"sourcesContent":["import { create } from 'zustand';\r\nimport * as SecureStore from 'expo-secure-store';\r\nimport { api } from '../services/api';\r\n\r\ninterface User {\r\n  id: string;\r\n  email: string;\r\n  name: string;\r\n  avatar?: string;\r\n  role: string;\r\n}\r\n\r\ninterface AuthState {\r\n  user: User | null;\r\n  token: string | null;\r\n  isAuthenticated: boolean;\r\n  isLoading: boolean;\r\n  error: string | null;\r\n\r\n  // Actions\r\n  login: (email: string, password: string) => Promise<void>;\r\n  register: (name: string, email: string, password: string) => Promise<void>;\r\n  logout: () => Promise<void>;\r\n  checkAuth: () => Promise<void>;\r\n  clearError: () => void;\r\n}\r\n\r\nconst TOKEN_KEY = 'auth_token';\r\nconst USER_KEY = 'auth_user';\r\n\r\nexport const useAuthStore = create<AuthState>((set, get) => ({\r\n  user: null,\r\n  token: null,\r\n  isAuthenticated: false,\r\n  isLoading: true,\r\n  error: null,\r\n\r\n  login: async (email: string, password: string) => {\r\n    set({ isLoading: true, error: null });\r\n    try {\r\n      const response = await api.post('/auth/login', { email, password });\r\n      const { user, accessToken } = response.data;\r\n\r\n      await SecureStore.setItemAsync(TOKEN_KEY, accessToken);\r\n      await SecureStore.setItemAsync(USER_KEY, JSON.stringify(user));\r\n\r\n      set({\r\n        user,\r\n        token: accessToken,\r\n        isAuthenticated: true,\r\n        isLoading: false,\r\n      });\r\n    } catch (error: any) {\r\n      set({\r\n        error: error.response?.data?.message || 'Login failed',\r\n        isLoading: false,\r\n      });\r\n      throw error;\r\n    }\r\n  },\r\n\r\n  register: async (name: string, email: string, password: string) => {\r\n    set({ isLoading: true, error: null });\r\n    try {\r\n      const response = await api.post('/auth/register', { name, email, password });\r\n      const { user, accessToken } = response.data;\r\n\r\n      await SecureStore.setItemAsync(TOKEN_KEY, accessToken);\r\n      await SecureStore.setItemAsync(USER_KEY, JSON.stringify(user));\r\n\r\n      set({\r\n        user,\r\n        token: accessToken,\r\n        isAuthenticated: true,\r\n        isLoading: false,\r\n      });\r\n    } catch (error: any) {\r\n      set({\r\n        error: error.response?.data?.message || 'Registration failed',\r\n        isLoading: false,\r\n      });\r\n      throw error;\r\n    }\r\n  },\r\n\r\n  logout: async () => {\r\n    await SecureStore.deleteItemAsync(TOKEN_KEY);\r\n    await SecureStore.deleteItemAsync(USER_KEY);\r\n    set({\r\n      user: null,\r\n      token: null,\r\n      isAuthenticated: false,\r\n    });\r\n  },\r\n\r\n  checkAuth: async () => {\r\n    try {\r\n      const token = await SecureStore.getItemAsync(TOKEN_KEY);\r\n      const userJson = await SecureStore.getItemAsync(USER_KEY);\r\n\r\n      if (token && userJson) {\r\n        const user = JSON.parse(userJson);\r\n        set({\r\n          user,\r\n          token,\r\n          isAuthenticated: true,\r\n          isLoading: false,\r\n        });\r\n      } else {\r\n        set({ isLoading: false });\r\n      }\r\n    } catch (error) {\r\n      set({ isLoading: false });\r\n    }\r\n  },\r\n\r\n  clearError: () => set({ error: null }),\r\n}));\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}